% +--------------------------------------------------+
% | Typeset this file to get the documentation.      |
% +--------------------------------------------------+
%
% Copyright (c) 1998 1999 2000 by Javier Bezos.
% All Rights Reserved.
%
% This file is part of the titlesec distribution release 2.3.5
% -----------------------------------------------------------
%
% This program can be redistributed and/or modified under the terms
% of the LaTeX Project Public License Distributed from CTAN
% archives in directory macros/latex/base/lppl.txt; either
% version 1 of the License, or any later version.

\def\fileversion{2.3.5}
\def\docdate{December 29, 2000}

\documentclass{ltxguide}
\usepackage[bf,sf,compact,topmarks,calcwidth,pagestyles]{titlesec}
\usepackage{titletoc}
\usepackage{multicol}
\usepackage[dvips]{graphics}
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\RequirePackage[perpage]{footmisc}
\usepackage[civil=times,cs=pochaev]{hipfonts}

\tolerance 1700

\def\contentsname{Оглавление}
\def\figurename{Рис.}
\def\tablename{Табл.}

\title{Пакет \textsf{HIP\TeX}
\footnote{Текущая версия пакета \textsf{HIP\TeX} - 0.5.9.  \copyright{} 2000-2001.
  Александр Воинов.}}

\author{Александр Воинов\footnote{Пожалуйста, посылайте сообщения об ошибках
по адресу аvv@quasar.ipa.nw.ru}}

\date{9 апреля 2000 года}

\widenhead{2.1pc}{0pc}
\titlelabel{\thetitle.\quad}

\renewpagestyle{plain}[\small\sffamily\slshape]{
  \footrule
  \setfoot{}{\usepage}{}}

\newpagestyle{myps}[\small\sffamily\slshape]{
  \headrule
  \sethead{HIP\TeX}{\sectiontitle}{\usepage}}
  
\pagestyle{myps}

\newcommand{\examplesep}{%
  \begin{center}%
    \rule{4pt}{4pt}%
  \end{center}}

\contentsmargin{0pt}
\titlecontents{section}[1.8pc]
  {\addvspace{3pt}\bfseries}
  {\contentslabel[\thecontentslabel.]{1.8pc}}
  {}
  {\quad\thecontentspage}

\titlecontents*{subsection}[1.8pc]
  {\small}
  {\thecontentslabel. }
  {}
  {, \thecontentspage}
  [.---][.]

\addtolength{\topmargin}{-3pc}
\addtolength{\textwidth}{6pc}
\addtolength{\oddsidemargin}{-2pc}
\addtolength{\textheight}{7pc}

%\raggedright
\parindent1em
\parskip0pt

\begin{document}

\cs
\civil
\maketitle
\tableofcontents
\section{Введение}

Пакет HIP\TeX\ предназначен для набора и верстки церковнославянских текстов,
в т.ч. таких, где церковнославянский текст перемежается с
гражданским русским. Кроме того, узкое подмножество введенных в пакете
определений позволяет задавать на церковнославянском языке подтекстовку под
нотами, набранными с помощью пакета MusiX\TeX.

Название пакета происходит от аббревиатуры HIP, обозначающей
общепризнанный стандарт инвариантной транслитерации церковнославянских
текстов средствами русского гражданского алфавита и минимального
набора символов кода ASCII, поддерживаемых большинством имеющимихся на
настоящий момент компьютеров. Стандарт HIP разработан М.Гринчуком в
рамках дискуссии, поддерживаемой списком рассылки {\tt
  \hbox{list@des-NT.tstu.ru}}. Его описание см. на сайте <<Печатный
двор>>\footnote{\tt http://www.pechatnyj\_dvor.boom.ru/docs.html.}.

\section{Руководство пользователя}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Практическое использование пакета HIP\TeX\ подразумевает включение в преамбулу
документа \LaTeX\ одного из следующих стилевых пакетов.

\begin{decl}
|hipfonts|
\end{decl}

Стилевой пакет |hipfonts| вводит базовый набор определений, которые позволяют
включать фрагменты на церковнославянском языке в произвольный документ \LaTeX.

\begin{decl}
|hipbook|
\end{decl}

Стилевой класс |hipbook| вводит дополнительные определения, облегчающие
верстку книг и буклетов, соответствующих традициям богослужебной литературы
Русской православной церкви.

\subsection{Требования к системе}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для использования стилевого класса |hipbook| в текущей конфигурации
системы \TeX\ должны присутствовать следующие стилевые пакеты:
|titlesec| версии не ниже 2.3.5, |extsizes|, |footmisc|, |geometry|,
|color|, |graphics|, |fontenc|, |inputenc|.

\subsection{Стандарт HIP и пакет HIP\TeX}\label{sec:hip}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Основная идея пакета HIP\TeX\ заключается в том, чтобы дать
пользователю возможность набирать и править текст, составляющий
верстаемую публикацию, {\em непосредственно} в обозначениях HIP. По
ознакомлении с кодировкой HIP, пользователю, таким образом, достаточно
дополнительно освоить не более десятка команд \LaTeX, чтобы иметь
возможность сверстать любой из выставленных на сайте <<Печатный двор>>
текстов и даже набрать такой текст <<с нуля>>.

Приведем краткую сводку обозначений стандарта HIP (версии HIP-6B).

\begin{center}
  \begin{table}[htbp]
    \centering
    \vskip -1\baselineskip
    \caption{Кодировка букв церковно-славянского алфавита русскими и латинскими
  буквами и символами ASCII:}       
    \label{tab:hip}                              
\vskip \baselineskip
\begin{tabular}[h]{llllllllllllllllll}
  {\cs А}    & {\tt А}     & \vline & {\cs а}    & {\tt а}   & \vline &   {\cs Н}    & {\tt Н}     & \vline & {\cs н}    & {\tt н}               & \vline &   {\cs Ш}    & {\tt Ш}     & \vline & {\cs ш}    & {\tt ш}    \\ 
  {\cs Б}    & {\tt Б}     & \vline & {\cs б}    & {\tt б}   & \vline &   {\cs О}    & {\tt О}     & \vline & {\cs о}    & {\tt о}               & \vline &   {\cs Щ}    & {\tt Щ}     & \vline & {\cs щ}    & {\tt щ}    \\ 
  {\cs В}    & {\tt В}     & \vline & {\cs в}    & {\tt в}   & \vline &   {\cs _О}   & {\tt \_О}   & \vline & {\cs _о}   & {\tt \_о}             & \vline &   {\cs }     & {\tt}       & \vline & {\cs ъ}    & {\tt ъ}    \\ 
  {\cs Г}    & {\tt Г}     & \vline & {\cs г}    & {\tt г}   & \vline &   {\cs W}    & {\tt W}     & \vline & {\cs w}    & {\tt w}               & \vline &   {\cs }     & {\tt}       & \vline & {\cs ы}    & {\tt ы}    \\ 
  {\cs Д}    & {\tt Д}     & \vline & {\cs д}    & {\tt д}   & \vline &   {\cs П}    & {\tt П}     & \vline & {\cs п}    & {\tt п}               & \vline &   {\cs }     & {\tt}       & \vline & {\cs ь}    & {\tt ь}    \\ 
  {\cs Е}    & {\tt Е}     & \vline & {\cs е}    & {\tt е}   & \vline &   {\cs Р}    & {\tt Р}     & \vline & {\cs р}    & {\tt р}               & \vline &   {\cs JЬ}   & {\tt JЬ}    & \vline & {\cs jь}   & {\tt jь}   \\ 
  {\cs }     & {\tt }      & \vline & {\cs _е}   & {\tt \_е} & \vline &   {\cs С}    & {\tt С}     & \vline & {\cs с}    & {\tt с}               & \vline &   {\cs Ю}    & {\tt Ю}     & \vline & {\cs ю}    & {\tt ю}    \\ 
  {\cs Ж}    & {\tt Ж}     & \vline & {\cs ж}    & {\tt ж}   & \vline &   {\cs Т}    & {\tt Т}     & \vline & {\cs т}    & {\tt т}               & \vline &   {\cs JА}   & {\tt JА}    & \vline & {\cs jа}   & {\tt jа}   \\ 
  {\cs S}    & {\tt S}     & \vline & {\cs s}    & {\tt s}   & \vline &   {\cs О_у}  & {\tt О\_у}  & \vline & {\cs о_у}  & {\tt о\_у}            & \vline &   {\cs Я}    & {\tt Я}     & \vline & {\cs я}    & {\tt я}    \\ 
  {\cs З}    & {\tt З}     & \vline & {\cs з}    & {\tt з}   & \vline &   {\cs У}    & {\tt У}     & \vline & {\cs у}    & {\tt у}               & \vline &   {\cs _КС}  & {\tt \_КС}  & \vline & {\cs _кс}  & {\tt \_кс} \\ 
  {\cs И}    & {\tt И}     & \vline & {\cs и}    & {\tt и}   & \vline &   {\cs Ф}    & {\tt Ф}     & \vline & {\cs ф}    & {\tt ф}               & \vline &   {\cs _ПС}  & {\tt \_ПС}  & \vline & {\cs _пс}  & {\tt \_пс} \\ 
  {\cs I}    & {\tt I}     & \vline & {\cs i}    & {\tt i}   & \vline &   {\cs Х}    & {\tt Х}     & \vline & {\cs х}    & {\tt х}               & \vline &   {\cs F}    & {\tt F}     & \vline & {\cs f}    & {\tt f}    \\ 
  {\cs К}    & {\tt К}     & \vline & {\cs к}    & {\tt к}   & \vline &   {\cs W\т}  & {\tt W\char92т}   & \vline & {\cs w\т}  & {\tt w\char92т} & \vline &   {\cs V}    & {\tt V}     & \vline & {\cs v}    & {\tt v}    \\ 
  {\cs Л}    & {\tt Л}     & \vline & {\cs л}    & {\tt л}   & \vline &   {\cs Ц}    & {\tt Ц}     & \vline & {\cs ц}    & {\tt ц}               & \\
  {\cs М}    & {\tt М}     & \vline & {\cs м}    & {\tt м}   & \vline &   {\cs Ч}    & {\tt Ч}     & \vline & {\cs ч}    & {\tt ч}               & \\
              
\end{tabular}                                    
\vskip -1\baselineskip
  \end{table}
\end{center}

При использовании этих обозначений важно помнить, что стандарт HIP
постулирует, что русские и латинские буквы с
неразличимыми начертаниями ({\tt e}, {\tt K}, {\tt М} и т.д.) обозначают один и то же символ.

\begin{center}
  \begin{table}[htbp]
    \centering
    \vskip -1\baselineskip
    \caption{Кодировка надстрочных знаков:}       
    \vskip \baselineskip
    \label{tab:ttl}                              
\begin{tabular}[h]{lllll}
{\cs а'}   & {\tt а'}        & \vline & {\cs а~}   & {\tt а\char126}      \\
{\cs а`}   & {\tt а`}        & \vline & {\cs а\c}  & {\tt а\char92c}      \\
{\cs а^}   & {\tt а\char94}  & \vline & {\cs а\г}  & {\tt а\char92г}      \\
{\cs а=}   & {\tt а=}        & \vline & {\cs а\д}  & {\tt а\char92д}      \\
{\cs а='}  & {\tt а='}       & \vline & {\cs а\о}  & {\tt а\char92о}      \\
{\cs а=`}  & {\tt а=`}       & \vline & {\cs а\р}  & {\tt а\char92р}      \\
{\cs а\ъ}  & {\tt а\char92ъ} & \vline       &  &       \\
\end{tabular}                                    
\vskip -1\baselineskip
  \end{table}
\end{center}

\subsection{Публикация общего вида с использованием стиля hipfonts}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Примерный вид преамбулы документа \LaTeX, задающего публикацию общего
вида, где допустимы вставки на церковнославянском языке\footnote{Как частный
  случай, такая публикация может целиком состоять из церковнославянского
  текста, однако в данном случае термином <<публикация общего вида>> мы
  противопоставляем такой документ документу, приготовленному с помощью класса
  |hipbook|.} может быть таким:

\begin{verbatim}
\documentclass[12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[civil=times]{hipfonts}
\end{verbatim}

Директивы, включающие пакеты |fontenc| и |inputenc|, должны предшествовать
включению пакета |hipfonts|.

\begin{decl}
|civil = <fontfamily>| \\
|cs    = <fontfamily>|
\end{decl}

Ключевые параметры пакета |civil| и |cs| определяют гарнитуру
гражданского и церковнославянского шрифта соответственно, которые будут
использоваться в командах переключения шрифтов. Допустимыми для настоящей
версии значениями для параметра |civil| являются |lh|, |antiqua| и |times|,
для параметра |cs| -- |izhitsa|.
\begin{decl}
|lh|
\end{decl}
Гарнитура LH (значение по умолчанию), входящая в современные комплектации пакетов te\TeX\
  и Mik\TeX.
\begin{decl}
|antiqua|
\end{decl}
Гарнитура Antiqua из пакета PsCyr.
\begin{decl}
|times|
\end{decl}
Гарнитура Times из пакета PsCyr.

\begin{decl}
|izhitsa|
\end{decl}
Для параметра |cs| в настоящей версии пакета допустимо одно значение
|izhitsa|, так что в явном употреблении этого параметра пока смысла
нет. Гарнитура IzhitsaCS, включаемая этим значением параметра,
получена на основе широко распространенного шрифта Izhitsa.

\begin{decl}
|\cs|
\end{decl}

Команда |\cs| переключает текущую шрифтовую гарнитуру на ту, что указана
в качестве значения параметра |cs|. Кроме того, эта команда переопределяет символы
|~|, |_| и |^| в соответствии с кодировкой HIP. 

\begin{decl}
|\civil|
\end{decl}

Команда |\civil| переключает текущую шрифтовую гарнитуру на ту, что указана в
качестве значения параметра |civil|. Кроме того, эта команда возвращает
символы |~|, |_| и |^| к их стандартным для системы \TeX\ смыслу, то есть:
неразрывный пробел, нижний и верхний индекс соответственно. В режиме |cs|,
как видно из п.\ref{sec:hip}, символ |~| обозначает титло, а неразрывный пробел
обозначается двумя идущими подряд символами |~|.

Приведем несколько примеров.

\subsubsection{Церковнославянская цитата в гражданском тексте}

<<Да не прельстит тебя диавол под видом добра, как сказано: {\cs бл~ги'ми словесы`
и= бл~гослове'нiемъ прельща'ютъ сердца` неsло'бивыхъ} (Римл. 16,
18).>>\footnote{Из книги <<Руководство к духовной жизни преподобных
  отцев Варсануфия Великого и Иоанна>>, Изд. <<Правило веры>>, 1995,
  стр. 229, ответ 327.}
На языке \LaTeX\ этот фрагмент выглядит следующим образом:

\begin{verbatim}
<<<<Да не прельстит тебя диавол под видом добра, как сказано: {\cs бл~ги'ми 
словесы` и= бл~гослове'нiемъ прельща'ютъ сердца` неsло'бивыхъ} 
(Римл. 16, 18).>>>>
\end{verbatim}

\subsubsection{Грамматическая таблица}

Последний пример будет, по-видимому, самым сложным для приступающих к
изучению системы \TeX, но он же демонстрирует и гибкость этой системы.
Одна из таблиц, приведенных в книге иером. (ныне архиеп.) Алипия (Гамановича)
<<Грамматика церковно-славянского языка>>\footnote{Изд. МП <<Паломник>>,
  1991, стр. 83.} будет в нашем случае выглядеть
следующим образом:

\vskip \baselineskip
\begin{center}
\begin{tabular}{llclcl}

% Заголовок таблицы:
\multicolumn{6}{c}{Множественное число.}\\

% заголовки столбцов:
~ & муж. род & & ср. род & & жен. род\\

% первая строка:
И. В. & {\cs два`, _о='ба} & \vline & {\cs двjь`, _о='бjь} 
                           & \vline & {\cs двjь`, _о='бjь}\\

% вторая строка:
Р. П. & {\cs двою`} или {\cs дву`, _о=бою`} & \vline &
                   \multicolumn{3}{l}{
                     \raisebox{-0.7em}[0pt][0pt]{{\Large$\}$} Для всех родов.}
                     }\\

% третья строка:
Д. Т. & {\cs двjьма`, _о=бjь'ма} & \vline & \multicolumn{3}{l}{}\\

\end{tabular}
\end{center}

Эта таблица получена с помощью следующего текста на языке \LaTeX:

\begin{verbatim}
\begin{center}
\begin{tabular}{llclcl}

% Заголовок таблицы:
\multicolumn{6}{c}{Множественное число:}\\

% заголовки столбцов:
~ & муж. род & & ср. род & & жен. род\\

% первая строка:
И. В. & {\cs два`, _о='ба} & \vline & {\cs двjь`, _о='бjь} 
                           & \vline & {\cs двjь`, _о='бjь}\\

% вторая строка:
Р. П. & {\cs двою`} или {\cs дву`, _о=бою`} & \vline &
         \multicolumn{3}{l}{
           \raisebox{-0.7em}[0pt][0pt]{{\Large$\}$} Для всех родов.}
           }\\

% третья строка:
Д. Т. & {\cs двjьма`, _о=бjь'ма} & \vline & \multicolumn{3}{l}{}\\

\end{tabular}
\end{center}
\end{verbatim}

\subsection{Публикация класса hipbook}

Стилевой класс |hipbook| предназначен для получения публикаций
книжного или буклетного типа, страницы которого могут иметь вид как показано
на рис.\ref{pict1}.

\begin{center}
\begin{figure}[tbp]
\begin{tabular}[c]{cc}
      \fbox{
      \scalebox{0.6}{\includegraphics* [10, 370] [290, 800]{test20_1}}
      } &
      \fbox{
      \scalebox{0.6}{\includegraphics* [10, 370] [290, 800]{test20_2}}
      }
\end{tabular}
%\vskip \baselineskip
\caption{\label{pict1}Страницы книги стиля hipbook.}
\end{figure}
\end{center}

\vskip -2\baselineskip
Преамбула документа в данном случае, если не подключаются дополнительные
стилевые пакеты, может состоять из одной команды:

\begin{verbatim}
\documentclass[12pt,twoside,a6paper,dvips,civil=antiqua,cs=pochaev]{hipbook}
\end{verbatim}

\begin{decl}
  |hipbook|
\end{decl}

Класс |hipbook| может принимать несколько неключевых параметров
(|12pt|, |14pt|, |twoside|, |a4paper|, |a5paper|, |a6paper|, |dvips|, |pdftex|, |xdvi|) и два
ключевых -- |civil| и |cs|.

\begin{decl}
  |12pt|\\
  |14pt|
\end{decl}

Параметры |12pt| и |14pt| определяют кегль, которым будет верстаться основной
текст публикации. Очевидно, что они являются взаимоисключающими, поэтому, если
почему-либо в списке параметров пакета указано более одного такого параметра,
то все, кроме последнего, будут проигнорированы.

\begin{decl}
  |twoside|
\end{decl}

Параметр |twoside| задает двусторонний формат публикации.

\begin{decl}
  |a4paper|\\
  |a5paper|\\
  |a6paper|
\end{decl}

Параметры вида |a*paper| определяют размер страницы результирующего документа.
Эти параметры также являются взаимоисключающими.

\begin{decl}
  |dvips|\\
  |pdftex|\\
  |xdvi|
\end{decl}

Параметры этой группы определяют способ включения в документ графических
образов и переключения в нем цветов и совпадают по семантике с
соответствующими параметрами пакетов |graphics| и |color|. Эти параметры также
являются взаимоисключающими. Выбор подходящего из них определяется тем, какие
последовательности вызовов каких утилит применяются для просмотра и/или печати
данного документа. Параметр |dvips| используется тогда, когда предполагается,
по получении файла |DVI|, преобразовать его в файл в формате Postscript с
помощью утилиты |dvips|. В режиме |dvips| расширением по умолчанию для
графических файлов является |.eps|.  Параметр |pdftex| указывается тогда,
когда предполагается создание файла в формате |PDF| непосредственно по
исходному \TeX-файлу с помощью утилиты |pdflatex|. В этом случае расширением
по умолчанию для графических файлов будет |.pdf|. Параметр |xdvi| предусмотрен
в нашем случае исключительно для обхода ошибки в программе просмотра |YaP| (из
комплекта Mik\TeX версии 1.20е), которая не может без искажений отобразить
текст, в котором цвета фрагментов переключаются в режиме |dvips|. В последнем
случае предлагается <<отлаживать>> верстку в режиме |xdvi|, а для получения
окончательной версии для печати перекомпилировать исходный текст в режиме
|dvips| или |pdftex|.

\begin{decl}
  |civil|\\
  |cs|
\end{decl}

Эти параметры имеют тот же смысл, и принимают те же значения, что и
соответствующие параметры пакета |hipfonts|.

\subsubsection{Стандартное вступление для книги/буклета}

Рассмотрим примерное продолжение описания книги после приведенной выше
преамбулы:

\begin{verbatim}
\begin{document}
\stdcrosstitle{Вoскре'сный w=ктw'ихъ}
\maketitle
\stdsecondpage
\hdrcrosspage
\section{Вoскре'сный w=ктw'ихъ}
\subsection{Недjь'ля, гла'съ пе'рвый}
\subsubsection{Стiхи^ры на Гд\си воззва'хъ, гла'съ а~}
\end{verbatim}

\begin{decl}
  |stdcrosstitle{<текст названия книги>}|\\
  |stdsecondpage|
\end{decl}

Команды |stdcrosstitle| и |stdsecondpage| оформляют первую и вторую страницу 
как показано на Рис.\ref{pict2}. В соответствии с соглашениями
пакета \LaTeX, для того, чтобы описание первой страницы было реально
обработано, необходимо выполнить команду |maketitle| (что и делается в
приведенном примере).

\begin{figure}[h]
  \begin{center}
    \fbox{
      \scalebox{0.5}{\includegraphics* [20, 200] [396, 750]{ot_1}}
      }
    \fbox{
      \scalebox{0.5}{\includegraphics* [20, 200] [396, 750]{ot_2}}
      }
  \end{center}
  \caption{\label{pict2}Первая и вторая страницы книги.}
\end{figure}

\begin{decl}
  |hdrcrosspage|
\end{decl}

Команда |hdrcrosspage| оформляет начальную страницу нового раздела (секции)
книги. См. Рис.\ref{pict1}, левую страницу.

\begin{decl}
  |section[<текст для колонтитула>]{текст заголовка}|\\
  |subsection[<текст для колонтитула>]{текст заголовка}|\\
  |subsubsection[<текст для колонтитула>]{текст заголовка}|
\end{decl}

Заголовки и подзаголовки <<секций>> (разделов) книги оформляются в рамках
класса |hipbook| с помощью пакета |titlesec|. Поэтому при необходимости
изменить какие-либо атрибуты заголовков следует руководствоваться
описанием этого пакета.

\subsubsection{Атрибуты рядовой страницы книги. Колонтитулы, бегущее слово
следующей страницы}

\begin{decl}
  |hipbookpage|
\end{decl}

По умолчанию, если не изменены описания стилей страниц, все
<<нормальные>> страницы книги (т.е. все, кроме первой, возможно
второй, если она оформлена с помощью команды |stdsecondpage| и
страниц, оформленных как |hdrcrosspage|) оформляются в соответствии со
стилем |hipbookpage| и имеют такой вид, как показано на
Рис.\ref{pict1} (правая стр.). Пользователю нет необходимости явно задавать этот
стиль страницы, так как все уклонения от него производятся с
помощью команды |thispagestyle|, которая действует только для одной
текущей страницы. 

Верхний колонтитул страницы |hipbookpage| содержит бегущий заголовок
подраздела (|section| для четной страницы, |subsection| для нечетной),
номер страницы арабским числом гражданским шрифтом, разделительную
линию. Нижний колонтитул может содержать в правом углу начальное слово
следующей страницы, как принято в богослужебной
литературе. Отображение этих слов производится в два этапа, на
завершающей стадии верстки книги. Сначала полученный по последней
корректуре книги |DVI|-файл обрабатывается утилитой |mkfwp|.

\begin{decl}
  |mkfwp <имя dvi- или tex-файла без расширения>[.dvi]|
\end{decl}

Результатом работы утилиты |mkfwp| является файл с тем же именем, что и имя
dvi-файла, но с расширением |.fwp|. Это -- текстовый файл\footnote{Знать формат этого файла
небесполезно ввиду того, что иногда, хотя и редко, может понадобиться
подправить его вручную. С выходом новых версий пакета HIP\TeX, впрочем,
необходимость в этом должна уменьшаться.}, в котором каждая
строка соответствует очередной странице документа и содержит слово, которое
надо включить в колонтитул {\emданной} страницы. Каждая такая строка
завершается символом комментария (|%|). 

\subsubsection{Разметка элементов текста}

\begin{decl}
  |\bukv{<текст>}|\\
  |\Bukv{<текст>}|
\end{decl}

Команды |\bukv| и |\Bukv| предназначены для оформления <<красной строки>> -
первой буквы очередного абзаца. Их мнемоника соответствует <<простой>>
и <<красивой>> буквице, с учетом того, что их <<стили>> могут меняться пользователем.
Ввиду отсутствия механизма буквиц в текущей версии пакета обе эти
команды реализуют <<киноварь>> -- изменение цвета буквы на
красный. Однако, при наборе новых текстов с помощью данного пакета
рекомендуется иметь в виду предполагаемое различие между этими
командами на уровне {\em логической разметки} и не злоупотреблять
командой |\Bukv|, используя ее, например, только в начале больших
разделов. Примеры:

\begin{verbatim}
\bukv{В}еч_e'рнiя на'шя мл~твы:
\bukv{И=}з\ъ глубины` воззва'хъ къ тебjь` гд\си:
\bukv{JА='}кw возвели'чишася дjьла` твоя^ гд\си:
\end{verbatim}

\begin{decl}
  |\rem{<текст>}|
\end{decl}

Команда |\rem| служит для выделения (чаще всего -- киноварью)
фрагмента текста (обычно в пределах абзаца), который не предназначен
для произнесения, а передает определенную метаинформацию. Пример:

\begin{verbatim}
\bukv{С}т~ы'й бж~е, ст~ы'й крjь'пкiй, ст~ы'й безсме'ртный, 
поми'луй на'съ. \rem{три'жды}.
\end{verbatim}

В нынешней версии пакета, ввиду малой распространенности устройств
цветной печати, физическая разметка фрагмента |\rem| состоит не только
в смене цвета, но и в изменении размера шрифта с нормального на |\small|.

\begin{decl}
  |\MakeUppercase|\\
  |\MUC|
\end{decl}

Использование стандартной для пакета \LaTeX\ команды |\MakeUppercase|
имеет в случае пакета HIP\TeX\ следующую особенность. Ввиду строгого
следования стандарту |HIP| возникает проблема изображения надстрочных
знаков над заглавными буквами. Вместо того, чтобы вводить новые
символы и команды, принято решение возложить эту работу на отображение
<<верхний-нижний регистр>>, так что команда вида
|\MakeUppercase{НЕДJЬ'ЛЯ, ГЛА'СЪ ТРЕ'ТIЙ}| или даже
|\MakeUppercase{недjь'ля, гла'съ тре'тiй}| приведет к правильному
изображению результирующего текста: {\cs \MakeUppercase{недjь'ля,
гла'съ тре'тiй}}. Ввиду такой ее особой роли, для команды
|\MakeUppercase| предусмотрено сокращение |\MUC|.

\subsubsection{Дополнительные команды}

Для удобства украшения книги некоторыми часто встречающимися в
богослужебной литературе орнаментами, вводятся следущие команды:

\begin{decl}
  |\delimpict|\\
  |\csendpict|\\
  |\csendpictsmall|\\
  |\hdrcross|
\end{decl}

Команда |\hdrcross| (Рис.\ref{pict4}) заполняет своим рисунком страницу по ширине для
форматов |a5paper| и |a6paper|. Ее имеет смысл использовать тогда,
когда нужен заметный разделитель, а заводить для этого новую страницу
с помощью |\hdrcrosspage| почему-либо нежелательно.

Рисунок |\delimpict| использовался в некоторых дореволюционных
изданиях Псалтири как разделитель между псалмами. Рисунки |\csendpict|
и |\csendpictsmall| обычно используются при логическом конце раздела,
когда следующий раздел начинается с новой страницы.

\begin{figure}[h]
\begin{center}
\begin{tabular}[c]{lc}
  \raisebox{1mm}[0pt][0pt]{{\tt \char92delimpict:}} & %\fbox{
    \scalebox{0.445}{\includegraphics* [23, 164] [256,
    188]{delimpict}}
  %}
\\
\\
\cline{1-2}
\\
  \raisebox{6mm}[0pt][0pt]{{\tt \char92csendpict:}} & %\fbox{
    \scalebox{0.09}{\includegraphics{csendpict}}
    %}
  \\
\\
\cline{1-2}
\\
  \raisebox{4mm}[0pt][0pt]{{\tt \char92csendpictsmall:}} & %\fbox{
    \scalebox{0.217}{\includegraphics* [0, 0] [352,
    127]{csendpictsmall}}
  %}
\\
\\
\cline{1-2}
\\
  \raisebox{3mm}[0pt][0pt]{{\tt \char92hdrcross:}} & %\fbox{
    \scalebox{0.3}{\includegraphics* [-26, 348] [637, 443]{hdrcross}}
    %}
\\
\end{tabular}
\end{center}
\caption{\label{pict4}Орнаменты, предоставляемые пакетом HIP\TeX.}
\end{figure}

\subsubsection{Оглавление книги}

Построение оглавления реализуется в пакете HIP\TeX\ с помощью пакета
|titletoc|, внимательное изучение которого в данном случае
рекомендуется.

Файл стилевого класса |hipbook| не подключает по умолчанию пакет
|titletoc|, так что последний надо подключать явно в преамбуле
документа. Кроме того, нужно решить, какие именно подзаголовки
предполагается включать в оглавление. После этого, как обычно,
командой |\tableofcontents| строится оглавление. Также как обычно, для
корректного построения оглавления необходимо несколько прогонов
документа через процессор |latex|. Для большего визуального выделения
страницы с оглавлением, вводится специальный стиль страницы
|hipcontentspage|. Приведем пример:

\begin{verbatim}
....
\usepackage{titletoc}

\titlecontents{section}[0em]{}{}{}{
    \titlerule*[0.5pc]{.}{\civil\footnotesize\contentspage}
}
\titlecontents{subsection}[0em]{}{}{}{}

\addtocontents{toc}{\protect\setcounter{tocdepth}{1}\ignorespaces}
....
\begin{document}
....
% в конце документа:
\clearpage
\thispagestyle{hipcontentspage}
\vskip -0.75\baselineskip
\tableofcontents

\end{document}

\end{verbatim}

\subsubsection{Построение буклета}

\begin{decl}
  |dvips|\\
  |pstops|
\end{decl}

Утилита |dvips| превращает файл в формате |DVI| в файл в формате
постскрипт. Утилита |pstops| из комплекта |psutils| (этот комплект
входит в состав пакета Mik\TeX) позволяет реорганизовать
постскрипт-файл таким образом, чтобы его можно было удобно распечатать
в виде буклета. В состав пакета HIP\TeX\ входят два командных файла
для интерпретатора командной строки ОС Unix (bash, tcsh, ksh, ...)
-- |a5book| и |a6book|, подготавливающих документ для буклетной печати
на листах американского формата |letter|. Они определены следующим образом:

{\scriptsize
\begin{verbatim}
# a5book:
pstops '4:-3L(28.5cm,-0.14cm)+0L(28.5cm,13.14cm),1L(28.5cm,-0.14cm)+-2L(28.5cm,13.14cm)' $1 >>$2
# a6book:
pstops '4:-3(0.45cm,-2cm)+0(10.55cm,-2cm),1(0.45cm,-2cm)+-2(10.55cm,-2cm)' $1 >>$2
\end{verbatim}
}

\subsection{Установка}

\subsubsection{Общие замечания}

После разархивирования пакета корнем дерева каталогов является каталог
|hiptex|, на который мы в дальнейшем будем ссылаться.

Наиболее <<болезненные>> (в смысле вероятности отсутствия в установках по умолчанию)
зависимости пакета HIP\TeX\ от внешних пакетов сводятся к следущему (Табл.\ref{deps}).

\begin{center}
\begin{table}[tbp]
\begin{tabular}[hc]{lp{10cm}}
PSCyr  & -- пакет русских шрифтов в формате Type-1.\\
titlesec v.2.3.5 & -- пакет для оформления заголовков.\\
extsizes & -- пакет, облегчающий работу с нестандартными размерами
шрифтов документа \LaTeX.\\
footmisc & \\
geometry & \\
savefnmark & \\
\end{tabular}
%\vskip \baselineskip
\caption{\label{deps}Зависимости пакета.}
\end{table}
\end{center}

\subsubsection{Дистрибутив te\TeX}

Наиболее просто установка пакета HIP\TeX\ осуществляется поверх
установленного дистрибутива te\TeX\ при наличии командного процессора
ОС Unix (bash, tcsh, ...). В этом случае как идентификация путей к
служебным каталогам дистрибутива, так и копирование файлов HIP\TeX\
выполняется командой |install.sh|, находящейся в корневой директории
каталога |hiptex|. После этого необходимо найти файл
|$TEXMF/dvips/config/updmap|, добавить в его секцию |extra_modules|
строчку |hiptex.map| и перезапустить этот файл\footnote{Имея,
естественно, необходимые для этого полномочия.}.

При необходимости и/или желании подключить словарь церковнославянских
переносов, который пока имеет экспериментальный статус, следует, как и
в других случаях, отредактировать файл |language.dat|, добавив к нему
строку

\begin{verbatim}
churchslavonic      cshyphts.tex
\end{verbatim}

\noindent после чего пойти в поддиректорию web2c и перегенерировать
форматный файл \LaTeX\ с помощью команды

\begin{verbatim}
initex latex.ltx
\end{verbatim}

После этого переключение в режим церковнославянских переносов
осуществляется с помощью команд

\begin{verbatim}
\selectlanguage{churchslavonic}\cs
\end{verbatim}

Выполение команды |\cs| здесь необходимо для того, чтобы вернуть три
специальных символа |~|, |_| и |^| в разряд букв. Естественно, в
преамбуле документа должен быть включен пакет |babel|, например, так:

\begin{verbatim}
\usepackage[russian,churchslavonic]{babel}
\end{verbatim}

Утилита |mkfwp| поставляется в скомпилированном виде только для платформы Win32, 
поэтому для других платформ ее следует скомпилировать самостоятельно с помощью 
компилятора языка С.

\subsubsection{Дистрибутив Mik\TeX}

В этом случае не приходится полагаться на наличие развитых процессоров
командной строки, поэтому проще и надежнее всего скопировать все
верхние подкаталоги каталога |hiptex| в одноименные подкаталоги
каталога |c:\localtexmf|. Последующие действия аналогичны изложенному
выше для случая дистрибутива te\TeX. Необходимо найти файл
|psfonts.map| и вручную добавить в него содержимое файла
|hiptex.map|. После этого следует перезапустить утилиту переконфигурации:

\begin{verbatim}
initexmf --update-fndb
initexmf --mkpsres
\end{verbatim}

Добавление словаря переносов осуществляется аналогично сказанному для
дистрибутива te\TeX.

Утилита |mkfwp|, как сказано выше, доступна в данном случае в скомпилированном виде, 
так что ее следует просто скопировать в каталог |c:\[local]texmf\miktex\bin|.

\section{Архитектура и реализация пакета. Для опытного пользователя
системы \TeX}

Данный раздел находится в стадии разработки.

\end{document}

